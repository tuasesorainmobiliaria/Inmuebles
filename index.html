<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inmuebles Maribel | Catálogo Profesional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .gradiente-maribel { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
        .card-inmueble { transition: all 0.3s ease; }
        .card-inmueble:hover { transform: translateY(-5px); }
        .btn-flecha { background: rgba(0,0,0,0.6); color: white; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; }
        .filtro-activo { background-color: #1e3a8a !important; color: white !important; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <header class="gradiente-maribel text-white py-12 px-4 shadow-2xl text-center">
        <h1 class="text-4xl md:text-5xl font-black tracking-tighter uppercase">Inmuebles Maribel</h1>
        <p class="mt-3 text-blue-100 text-xl font-light italic">"Transformo tu sueño en una realidad"</p>
    </header>

    <div class="max-w-7xl mx-auto px-6 -mt-8">
        <div class="bg-white p-4 rounded-2xl shadow-lg flex flex-wrap gap-2 justify-center border border-gray-100">
            <button onclick="filtrar('todos')" class="btn-filtro filtro-activo px-6 py-2 rounded-xl border font-bold transition-all hover:bg-gray-100">Todos</button>
            <button onclick="filtrar('Casa')" class="btn-filtro px-6 py-2 rounded-xl border font-bold transition-all hover:bg-gray-100 text-gray-600">Casas</button>
            <button onclick="filtrar('Apartamento')" class="btn-filtro px-6 py-2 rounded-xl border font-bold transition-all hover:bg-gray-100 text-gray-600">Apartamentos</button>
            <button onclick="filtrar('Venta')" class="btn-filtro px-6 py-2 rounded-xl border font-bold transition-all hover:bg-gray-100 text-gray-600 text-sm">En Venta</button>
            <button onclick="filtrar('Alquiler')" class="btn-filtro px-6 py-2 rounded-xl border font-bold transition-all hover:bg-gray-100 text-gray-600 text-sm">Alquiler</button>
        </div>
    </div>

    <main id="contenedor-casas" class="max-w-7xl mx-auto p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-4">
        <div class="col-span-full text-center py-20 italic text-gray-400">Cargando detalles...</div>
    </main>

    <footer class="bg-slate-900 text-white py-10 mt-12">
        <div class="max-w-7xl mx-auto text-center px-4">
            <h2 class="text-2xl font-bold italic">Inmuebles Maribel</h2>
            <div class="flex justify-center gap-6 mt-6 text-3xl">
                <a href="https://wa.me/584127085935" class="hover:text-green-400 transition-colors"><i class="fab fa-whatsapp"></i></a>
                <a href="#" class="hover:text-pink-400 transition-colors"><i class="fab fa-instagram"></i></a>
                <a href="#" class="hover:text-blue-400 transition-colors"><i class="fab fa-facebook"></i></a>
            </div>
            <p class="text-gray-500 text-xs mt-10">© 2026 Inmuebles Maribel - Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        const EXCEL_ID = '16dqDFvIQO9fPykDBD6PIWhf6_Sure1Q2_7yJtslTHZM';
        const WHATSAPP = '584127085935'; 
        let todasLasCasas = [];

        async function cargarCasas() {
            try {
                const res = await fetch(`https://docs.google.com/spreadsheets/d/${EXCEL_ID}/gviz/tq?tqx=out:json`);
                const texto = await res.text();
                const json = JSON.parse(texto.substr(47).slice(0, -2));
                todasLasCasas = json.table.rows;
                renderizar(todasLasCasas);
            } catch (e) { console.error(e); }
        }

        function renderizar(filas) {
            const contenedor = document.getElementById('contenedor-casas');
            contenedor.innerHTML = '';

            filas.forEach((fila, idx) => {
                if(idx === 0) return; 
                
                const titulo = fila.c[0]?.v || 'Propiedad';
                const precio = fila.c[1]?.v || 'Consultar';
                const desc = fila.c[2]?.v || '';
                const fotos = String(fila.c[3]?.v || '').split(',').map(f => f.trim()).filter(f => f !== "");
                const tipo = fila.c[4]?.v || '';
                const estado = fila.c[5]?.v || 'Venta';
                const hab = fila.c[6]?.v || '-';
                const banos = fila.c[7]?.v || '-';
                const garaje = fila.c[8]?.v || '-';

                const idCasa = `casa-${idx}`;

                contenedor.innerHTML += `
                    <div class="card-inmueble bg-white rounded-3xl shadow-lg overflow-hidden border border-gray-100 flex flex-col">
                        <div class="relative h-64 group">
                            <img id="img-${idCasa}" src="${fotos[0] || 'https://via.placeholder.com/400x300'}" class="w-full h-full object-cover">
                            <div class="absolute top-4 left-4 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full uppercase shadow-md">${estado}</div>
                            ${fotos.length > 1 ? `
                                <div class="absolute inset-0 flex items-center justify-between px-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                    <button onclick="cambiarFoto('${idCasa}', -1, ${JSON.stringify(fotos).replace(/"/g, '&quot;')})" class="btn-flecha"><i class="fas fa-chevron-left"></i></button>
                                    <button onclick="cambiarFoto('${idCasa}', 1, ${JSON.stringify(fotos).replace(/"/g, '&quot;')})" class="btn-flecha"><i class="fas fa-chevron-right"></i></button>
                                </div>
                            ` : ''}
                        </div>
                        <div class="p-5 flex-grow">
                            <h2 class="text-xl font-bold text-gray-800 leading-tight">${titulo}</h2>
                            <p class="text-blue-600 font-black text-2xl mt-1">${precio}</p>
                            
                            <div class="flex gap-4 my-4 text-gray-500 text-sm border-y border-gray-50 py-3 italic">
                                <span><i class="fas fa-bed mr-1 text-blue-400"></i> ${hab} Hab.</span>
                                <span><i class="fas fa-bath mr-1 text-blue-400"></i> ${banos} Bñ.</span>
                                <span><i class="fas fa-car mr-1 text-blue-400"></i> ${garaje} Pto.</span>
                            </div>

                            <p class="text-gray-500 text-sm line-clamp-2">${desc}</p>
                        </div>
                        <div class="px-5 pb-5 flex gap-2">
                            <a href="https://wa.me/${WHATSAPP}?text=Hola Maribel, me interesa: ${encodeURIComponent(titulo)}" 
                               class="flex-1 flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-bold shadow-md">
                                <i class="fab fa-whatsapp"></i> Consultar
                            </a>
                            <button onclick="compartir('${titulo}')" class="bg-gray-100 hover:bg-gray-200 text-gray-600 p-3 rounded-xl shadow-sm">
                                <i class="fas fa-share-alt"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        const indices = {};
        function cambiarFoto(id, direccion, lista) {
            if (!indices[id]) indices[id] = 0;
            indices[id] = (indices[id] + direccion + lista.length) % lista.length;
            document.getElementById(`img-${id}`).src = lista[indices[id]];
        }

        function filtrar(criterio) {
            document.querySelectorAll('.btn-filtro').forEach(b => b.classList.remove('filtro-activo', 'text-white'));
            event.target.classList.add('filtro-activo', 'text-white');
            if(criterio === 'todos') {
                renderizar(todasLasCasas);
            } else {
                const filtradas = todasLasCasas.filter((f, idx) => {
                    if(idx === 0) return true;
                    // Comparamos sin importar mayúsculas
                    const t = String(f.c[4]?.v || '').toLowerCase();
                    const e = String(f.c[5]?.v || '').toLowerCase();
                    const c = criterio.toLowerCase();
                    return (t === c || e === c);
                });
                renderizar(filtradas);
            }
        }

        function compartir(propiedad) {
            const url = window.location.href;
            const msg = `Mira esta propiedad en Inmuebles Maribel: ${propiedad} - ${url}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
        }

        cargarCasas();
    </script>
</body>
</html>
